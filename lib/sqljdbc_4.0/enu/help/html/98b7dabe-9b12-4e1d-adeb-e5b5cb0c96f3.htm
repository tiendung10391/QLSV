<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Understanding Concurrency Control</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="concurrency" /><meta name="Microsoft.Help.Id" content="98b7dabe-9b12-4e1d-adeb-e5b5cb0c96f3" /><meta name="Description" content="Concurrency control refers to the various techniques that are used to preserve the integrity of the database when multiple users are updating rows at the same time." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Understanding Concurrency Control</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Concurrency control refers to the various techniques that are used to preserve the integrity of the database when multiple users are updating rows at the same time. Incorrect concurrency can lead to problems such as dirty reads, phantom reads, and non-repeatable reads. The Microsoft JDBC Driver for SQL Server provides interfaces to all the concurrency techniques used by SQL Server to resolve these issues. </p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>For more information about SQL Server concurrency, see "Managing Concurrent Data Access" in SQL Server Books Online.</p></div></div><h1 class="heading">Remarks</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>The JDBC driver supports the following concurrency types:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Concurrency Type</p></th><th><p>Characteristics</p></th><th><p>Row Locks</p></th><th><p>Description</p></th></tr><tr><td><p>CONCUR_READ_ONLY</p></td><td><p>Read Only</p></td><td><p>No</p></td><td><p>Updates through the cursor are not allowed, and no locks are held on the rows that make up the result set.</p></td></tr><tr><td><p>CONCUR_UPDATABLE</p></td><td><p>Optimistic Read Write</p></td><td><p>No</p></td><td><p>Database assumes row contention is unlikely, but possible. Row integrity is checked with a timestamp comparison.</p></td></tr><tr><td><p>CONCUR_SS_SCROLL_LOCKS</p></td><td><p>Pessimistic Read Write</p></td><td><p>Yes</p></td><td><p>Database assumes row contention is likely. Row integrity is ensured with row locking.</p></td></tr><tr><td><p>CONCUR_SS_OPTIMISTIC_CC</p></td><td><p>Optimistic Read Write</p></td><td><p>No</p></td><td><p>Database assumes row contention is unlikely, but possible. Row integrity is verified with a timestamp comparison. </p><p>For SQL Server 2005 and later, the server will change this to CONCUR_SS_OPTIMISTIC_CCVAL if the table does not contain a timestamp column.</p><p>For SQL Server 2000, if the underlying table has a timestamp column, OPTIMISTIC WITH ROW VERSIONING is used even if OPTIMISTIC WITH VALUES is specified. If OPTIMISTIC WITH ROW VERSIONING is specified and the table does not have timestamps, OPTIMISTIC WITH VALUES is used.</p></td></tr><tr><td><p>CONCUR_SS_OPTIMISTIC_CCVAL</p></td><td><p>Optimistic Read Write</p></td><td><p>No</p></td><td><p>Database assumes row contention is unlikely, but possible. Row integrity is checked with a row data comparison.</p></td></tr></table></div></div><h1 class="heading">Result Sets That Are Not Updateable</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>An updatable result set is a result set in which rows can be inserted, updated, and deleted. In the following cases, SQL Server cannot create an updatable cursor. The exception generated is, "Result set is not updatable." </p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Cause</p></th><th><p>Description</p></th><th><p>Remedy</p></th></tr><tr><td><p>Statement is not created by using JDBC 2.0 (or later) syntax</p></td><td><p>JDBC 2.0 introduced new methods to create statements. If JDBC 1.0 syntax is used, the result set defaults to read-only.</p></td><td><p>Specify result set type and concurrency when creating the statement.</p></td></tr><tr><td><p>Statement is created by using TYPE_SCROLL_INSENSITIVE</p></td><td><p>SQL Server creates a static snapshot cursor. This is disconnected from the underlying table rows to help protect the cursor from row updates by other users.</p></td><td><p>Use TYPE_SCROLL_SENSITIVE, TYPE_SS_SCROLL_KEYSET, TYPE_SS_SCROLL_DYNAMIC, or TYPE_FORWARD_ONLY with CONCUR_UPDATABLE to avoid creating a static cursor.</p></td></tr><tr><td><p>Table design precludes a KEYSET or DYNAMIC cursor</p></td><td><p>The underlying table does not have unique keys to enable SQL Server to uniquely identify a row.</p></td><td><p>Add unique keys to the table to provide unique identification of each row.</p></td></tr></table></div></div><span id="seeAlsoSpan"><h1 class="heading">See Also</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="9ed5ad41-22e0-4e4a-8a79-10512db60d50.htm">Managing Result Sets with the JDBC Driver</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Send <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','01.00.12024.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/en-us/default.aspx.%0\A%0\d','Customer%20Feedback');">feedback</a> on this topic to Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.  All rights reserved.</a></p></span></div></div></body></html>