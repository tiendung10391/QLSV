<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Programming with SQLXML</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="adaptive buffering" /><meta name="System.Keywords" content="programming with sqlxml" /><meta name="System.Keywords" content="sqlxml" /><meta name="System.Keywords" content="xml" /><meta name="Microsoft.Help.Id" content="4d2cc57c-7293-4d92-b8b1-525e2b35f591" /><meta name="Description" content="This section describes how to use the Microsoft JDBC Driver for SQL Server API methods to store and retrieve an XML document in and from a relational database with SQLXML objects." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Programming with SQLXML</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>This section describes how to use the Microsoft JDBC Driver for SQL Server API methods to store and retrieve an XML document in and from a relational database with <span sdata="langKeyword" value="SQLXML"><span class="keyword">SQLXML</span></span> objects. </p><p>This section also contains information about the types of SQLXML objects and provides a list of important guidelines and limitations when using SQLXML objects.</p></div><h1 class="heading">Reading and Writing XML Data with SQLXML Objects</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>The following list describes how to use the Microsoft JDBC Driver for SQL Server API methods to read and write XML data with SQLXML objects:</p><ul><li><p>To create a SQLXML object, use the <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a> method of the <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a> class. Note that this method creates a SQLXML object without any data. To add <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> data to SQLXML object, call one of the following methods that are specified in the SQLXML interface: <b>setResult</b>, <b>setCharacterStream</b>, <b>setBinaryStream</b>, or <b>setString</b>.</p></li><li><p>To retrieve the SQLXML object itself, use the <b>getSQLXML</b> methods of the <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> class or the <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> class. </p></li><li><p>To retrieve the <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> data from a SQLXML object, use one of the following methods that are specified in the SQLXML interface: <b>getSource</b>, <b>getCharacterStream</b>, <b>getBinaryStream</b>, or <b>getString</b>. </p></li><li><p>To update the <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> data in a SQLXML object, use the <a href="abe8ff37-72e5-4ec1-a226-6b68dbf2c1b4.htm">updateSQLXML</a> method of the <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> class.</p></li><li><p>To store a SQLXML object in a database table column of type <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span>, use the <b>setSQLXML</b> methods of the <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> class or the <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> class.</p></li></ul><p>The example code in <a href="8f2ff25b-71fd-46d7-b6de-d656095d2aad.htm">SQLXML Data Type Sample</a> demonstrates how to perform these common API tasks. </p></div><h1 class="heading">Readable and Writable SQLXML Objects</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>The following table lists which types of SQLXML objects are supported by the setter, getter, and updater methods provided by the JDBC API. The columns in the table refer to the following: </p><ul><li><p>The <b>Method Name</b> column lists the supported getter, setter, and updater methods in the JDBC API.</p></li><li><p>The <b>Getter SQLXML Object</b> column represents a SQLXML object, which is created by either the <a href="8bcf9eda-b36c-480c-8bf2-91c392d5a0ee.htm">getSQLXML</a> method of the <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> class or the <a href="a07e0f30-cbc6-4ad7-b931-c30cad382e64.htm">getSQLXML</a> method of the <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> class.</p></li><li><p>The <b>Setter SQLXML Object</b> column represents a SQLXML object, which is created by the <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a> method of the <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a> class. Note that the setter methods below accept only a SQLXML object created by the <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a> method.</p></li></ul><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Method Name </p></th><th><p>Getter SQLXML Object</p><p>(Readable)</p></th><th><p>Setter SQLXML Object</p><p>(Writable)</p></th></tr><tr><td><p><b>CallableStatement.setSQLXML()</b></p></td><td><p>Not Supported</p></td><td><p>Supported</p></td></tr><tr><td><p><b>CallableStatement.setObject()</b></p></td><td><p>Not Supported</p></td><td><p>Supported</p></td></tr><tr><td><p><b>PreparedStatement.setSQLXML()</b></p></td><td><p>Not Supported</p></td><td><p>Supported</p></td></tr><tr><td><p><b>PreparedStatement.setObject()</b></p></td><td><p>Not Supported</p></td><td><p>Supported</p></td></tr><tr><td><p><b>ResultSet.updateSQLXML()</b></p></td><td><p>Not Supported</p></td><td><p>Supported</p></td></tr><tr><td><p><b>ResultSet.updateObject()</b></p></td><td><p>Not Supported</p></td><td><p>Supported</p></td></tr><tr><td><p><b>ResultSet.getSQLXML()</b></p></td><td><p>Supported</p></td><td><p>Not Supported</p></td></tr><tr><td><p><b>CallableStatement.getSQLXML()</b></p></td><td><p>Supported</p></td><td><p>Not Supported</p></td></tr></table></div><p>As shown in the table above, the setter SQLXML methods will not work with the readable SQLXML objects; similarly, the getter methods will not work with the writable SQLXML objects.</p><p>If the application invokes the <b>setObject</b> method by specifying a scale or a length parameter with a SQLXML object, the scale or length parameter is ignored.</p></div><h1 class="heading">Guidelines and Limitations when Using SQLXML Objects</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Applications can use SQLXML objects to read and write the XML data from and to the database. The following list provides information about specific limitations and guidance when using SQLXML objects: </p><ul><li><p>A SQLXML object can be valid only for the duration of the transaction in which it was created.</p></li><li><p>A SQLXML object received from a getter method can only be used to read data. </p></li><li><p>A SQLXML object created by the connection object can only be used to write data.</p></li><li><p>The application can invoke only one getter method on a readable SQLXML object to read data. After the getter method is invoked, all other getter or setter methods on the same SQLXML object fail. </p></li><li><p>The application can invoke only the <b>free</b> method on the SQLXML object after it is read or written to. However, it is still possible to process the returned stream or source as long as the underlying column or parameter is active. If the underlying column or parameter becomes inactive, the stream or source associated with the SQLXML object will be closed. If the underlying column or parameter is no longer valid, the underlying data will not be available for the Stream, Simple API for XML (SAX), and Streaming API for XML (StAX) getters.</p></li><li><p>The application can invoke only one setter method on a writable SQLXML object. After the setter method is invoked, all other setter or getter methods on the same SQLXML object fail.</p></li><li><p>To set data on the SQLXML object, the application must use the appropriate setter method and the functions in the returned object.</p></li><li><p>The <b>getSQLXML</b> methods of the <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> class and the <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> class returns <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> data if the underlying column is <span sdata="langKeyword" value="null"><span class="keyword">null</span></span>.</p></li><li><p>The setter objects can be valid through the connection they are created within.</p></li><li><p>Applications are not allowed to set a <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> value by using the setter methods provided by the SQLXML interface. The applications can set an empty string ("") by using the setter methods provided in the SQLXML interface. To set a <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> value, the applications should call one of the following:</p><ul><li><p>The <b>setNull</b> methods of the <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> class and <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> class.</p></li><li><p>The <b>setObject</b> methods of the <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> class and <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> class. </p></li><li><p>The <b>setSQLXML</b> methods of the <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> class and <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> class with a <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> parameter value.</p></li></ul></li><li><p>When working with XML documents, we recommend using Simple API for XML (SAX) and Streaming API for XML (StAX) parsers instead of Document Object Model (DOM) parsers for performance reasons.</p></li></ul><p>XML parsers cannot handle empty values. However, SQL Server allows applications to retrieve and store empty values from and to database columns of the XML data type. That means that when parsing the XML data, if the underlying value is empty, an exception is thrown by the parser. For DOM outputs, the JDBC driver catches that exception and throws an error. For SAX and Stax outputs, the error comes from the parser directly.</p></div><h1 class="heading">Adaptive Buffering and SQLXML Support</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>The binary and character streams returned by the SQLXML object obey the adaptive or full buffering modes. On the other hand, if the XML parsers are not streams, they will not obey the adaptive or full settings. For more information about adaptive buffering, see <span sdata="link"><a href="92d4e3be-c3e9-4732-9a60-b57f4d0f7cb7.htm">Using Adaptive Buffering</a></span>.</p></div><span id="seeAlsoSpan"><h1 class="heading">See Also</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="32b7217e-1f0c-473d-9a45-176daa81584e.htm">Supporting XML Data</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Send <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','01.00.12024.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/en-us/default.aspx.%0\A%0\d','Customer%20Feedback');">feedback</a> on this topic to Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.  All rights reserved.</a></p></span></div></div></body></html>