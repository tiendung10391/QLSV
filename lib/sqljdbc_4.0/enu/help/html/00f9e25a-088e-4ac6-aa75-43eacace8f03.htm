<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Using SQL Escape Sequences</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="SQL escape sequences" /><meta name="Microsoft.Help.Id" content="00f9e25a-088e-4ac6-aa75-43eacace8f03" /><meta name="Description" content="The Microsoft JDBC Driver for SQL Server supports the use of SQL escape sequences, as defined by the JDBC API. Escape sequences are used within an SQL statement to tell the driver that the escaped part of the SQL string should be handled differently." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Using SQL Escape Sequences</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>The Microsoft JDBC Driver for SQL Server supports the use of SQL escape sequences, as defined by the JDBC API. Escape sequences are used within an SQL statement to tell the driver that the escaped part of the SQL string should be handled differently. When the JDBC driver processes the escaped part of an SQL string, it translates that part of the string into SQL code that SQL Server understands. </p><p>There are five types of escape sequences that the JDBC API requires, and all are supported by the JDBC driver:</p><ul><li><p>LIKE wildcard literals</p></li><li><p>Function handling</p></li><li><p>Date and time literals</p></li><li><p>Stored procedure calls</p></li><li><p>Outer joins</p></li></ul><p>The escape sequence syntax used by the JDBC driver is the following:</p><p><span class="code">{keyword ...parameters...}</span></p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>SQL escape processing is always turned on for the JDBC driver.</p></div><p>The following sections describe the five types of escape sequences and how they are supported by the JDBC driver.</p></div><h1 class="heading">LIKE Wildcard Literals</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>The JDBC driver supports the <span class="code">{escape 'escape character'}</span> syntax for using LIKE clause wildcards as literals. For example, the following code will return values for col3, where the value of col2 literally begins with an underscore (and not its wildcard usage).</p><div class="sampleCode"><span codeLanguage="other"><pre>ResultSet rst = stmt.executeQuery("SELECT col3 FROM test1 WHERE col2 
LIKE '\\_%' {escape '\\'}");</pre></span></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>The escape sequence must be at the end of the SQL statement. For multiple SQL statements in a command string, the escape sequence needs to be at the end of each relevant SQL statement.</p></div></div><h1 class="heading">Function Handling</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>The JDBC driver supports function escape sequences in SQL statements with the following syntax:</p><div class="sampleCode"><span codeLanguage="other"><pre>{fn functionName}</pre></span></div><p>where <span class="code">functionName</span> is a function supported by the JDBC driver. For example:</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT {fn UCASE(Name)} FROM Employee</pre></span></div><p>The following table lists the various functions that are supported by the JDBC driver when using a function escape sequence:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>String Functions</p></th><th><p>Numeric Functions</p></th><th><p>Datetime Functions</p></th><th><p>System Functions</p></th></tr><tr><td><p>ASCII</p><p>CHAR</p><p>CONCAT</p><p>DIFFERENCE</p><p>INSERT</p><p>LCASE</p><p>LEFT</p><p>LENGTH</p><p>LOCATE</p><p>LTRIM</p><p>REPEAT</p><p>REPLACE</p><p>RIGHT</p><p>RTRIM</p><p>SOUNDEX</p><p>SPACE</p><p>SUBSTRING</p><p>UCASE</p></td><td><p>ABS</p><p>ACOS</p><p>ASIN</p><p>ATAN</p><p>ATAN2</p><p>CEILING</p><p>COS</p><p>COT</p><p>DEGREES</p><p>EXP</p><p>FLOOR</p><p>LOG</p><p>LOG10</p><p>MOD</p><p>PI</p><p>POWER</p><p>RADIANS</p><p>RAND</p><p>ROUND</p><p>SIGN</p><p>SIN</p><p>SQRT</p><p>TAN</p><p>TRUNCATE</p></td><td><p>CURDATE</p><p>CURTIME</p><p>DAYNAME</p><p>DAYOFMONTH</p><p>DAYOFWEEK</p><p>DAYOFYEAR</p><p>EXTRACT</p><p>HOUR</p><p>MINUTE</p><p>MONTH</p><p>MONTHNAME</p><p>NOW</p><p>QUARTER</p><p>SECOND</p><p>TIMESTAMPADD</p><p>TIMESTAMPDIFF</p><p>WEEK</p><p>YEAR</p></td><td><p>DATABASE</p><p>IFNULL</p><p>USER</p></td></tr></table></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>If you try to use a function that the database does not support, an error will occur.</p></div></div><h1 class="heading">Date and Time Literals</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>The escape syntax for date, time, and timestamp literals is the following: </p><div class="sampleCode"><span codeLanguage="other"><pre>{literal-type 'value'}</pre></span></div><p>where <span class="code">literal-type</span> is one of the following:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Literal Type</p></th><th><p>Description</p></th><th><p>Value Format</p></th></tr><tr><td><p>d</p></td><td><p>Date</p></td><td><p>yyyy-mm-dd</p></td></tr><tr><td><p>t</p></td><td><p>Time</p></td><td><p>hh:mm:ss [1]</p></td></tr><tr><td><p>ts</p></td><td><p>TimeStamp</p></td><td><p>yyyy-mm-dd hh:mm:ss[.f...]</p></td></tr></table></div><p>For example:</p><div class="sampleCode"><span codeLanguage="other"><pre>UPDATE Orders SET OpenDate={d '2005-01-31'} 
WHERE OrderID=1025</pre></span></div></div><h1 class="heading">Stored Procedure Calls</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>The JDBC driver supports the <span class="code">{? = call proc_name(?,...)}</span> and <span class="code">{call proc_name(?,...)}</span> escape syntax for stored procedure calls, depending on whether you need to process a return parameter. </p><p>A procedure is an executable object stored in the database. Generally, it is one or more SQL statements that have been precompiled. The escape sequence syntax for calling a stored procedure is the following: </p><div class="sampleCode"><span codeLanguage="other"><pre>{[?=]call procedure-name[([parameter][,[parameter]]...)]}</pre></span></div><p>where <span class="code">procedure-name</span> specifies the name of a stored procedure and <span class="code">parameter</span> specifies a stored procedure parameter.</p><p>For more information about using the <span class="code">call</span> escape sequence with stored procedures, see <span sdata="link"><a href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">Using Statements with Stored Procedures</a></span>.</p></div><h1 class="heading">Outer Joins</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>The JDBC driver supports the SQL92 left, right, and full outer join syntax. The escape sequence for outer joins is the following:</p><div class="sampleCode"><span codeLanguage="other"><pre>{oj outer-join}</pre></span></div><p>where outer-join is:</p><div class="sampleCode"><span codeLanguage="other"><pre>table-reference {LEFT | RIGHT | FULL} OUTER JOIN  
{table-reference | outer-join} ON search-condition</pre></span></div><p>where <span class="code">table-reference</span> is a table name and <span class="code">search-condition</span> is the join condition you want to use for the tables.</p><p>For example:</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT Customers.CustID, Customers.Name, Orders.OrderID, Orders.Status 
   FROM {oj Customers LEFT OUTER JOIN 
      Orders ON Customers.CustID=Orders.CustID} 
   WHERE Orders.Status='OPEN'</pre></span></div><p>The following outer join escape sequences are supported by the JDBC driver:</p><ul><li><p>Left outer joins</p></li><li><p>Right outer joins</p></li><li><p>Full outer joins</p></li><li><p>Nested outer joins</p></li></ul></div><span id="seeAlsoSpan"><h1 class="heading">See Also</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Using Statements with the JDBC Driver</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Send <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','01.00.12024.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/en-us/default.aspx.%0\A%0\d','Customer%20Feedback');">feedback</a> on this topic to Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.  All rights reserved.</a></p></span></div></div></body></html>