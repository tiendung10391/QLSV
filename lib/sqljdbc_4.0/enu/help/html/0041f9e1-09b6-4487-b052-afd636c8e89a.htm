<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Using Statements with Stored Procedures</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="statements with stored procedures" /><meta name="Microsoft.Help.Id" content="0041f9e1-09b6-4487-b052-afd636c8e89a" /><meta name="Description" content="A stored procedure is a database procedure, similar to a procedure in other programming languages, which is contained within the database itself." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Using Statements with Stored Procedures</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>A stored procedure is a database procedure, similar to a procedure in other programming languages, which is contained within the database itself. In SQL Server, stored procedures can be created by using Transact-SQL, or by using the common language runtime (CLR) and one of the Visual Studio programming languages such as Visual Basic or C#. Generally, SQL Server stored procedures can do the following: </p><ul><li><p>Accept input parameters and return multiple values in the form of output parameters to the calling procedure or batch.</p></li><li><p>Contain programming statements that perform operations in the database, including calling other procedures. </p></li><li><p>Return a status value to a calling procedure or batch to indicate success or failure (and the reason for failure).</p></li></ul><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>For more information about SQL Server stored procedures, see "Understanding Stored Procedures" in SQL Server Books Online.</p></div><p>To work with data in a SQL Server database by using a stored procedure, the Microsoft JDBC Driver for SQL Server provides the <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a>, <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a>, and <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> classes. Which class you use depends on whether IN (input) or OUT (output) parameters are required by the stored procedure. If the stored procedure requires no IN or OUT parameters, you can use the <b>SQLServerStatement</b> class; if the stored procedure will be called multiple times, or requires only IN parameters, you can use the <b>SQLServerPreparedStatement</b> class. If the stored procedure requires both IN and OUT parameters, you should use the <b>SQLServerCallableStatement</b> class. It is only when the stored procedure requires OUT parameters that you will need the overhead of using the <b>SQLServerCallableStatement</b> class.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Stored procedures can also return update counts and multiple result sets. For more information, see <span sdata="link"><a href="64cf4877-5995-4bfc-8865-b7618a5c8d01.htm">Using a Stored Procedure with an Update Count</a></span> and <span sdata="link"><a href="ab6a3cfa-073b-44e9-afca-a8675cfe5fd1.htm">Using Multiple Result Sets</a></span>.</p></div><p>When you use the JDBC driver to call a stored procedure with parameters, you must use the<span class="code"> call </span>SQL escape sequence together with the <a href="265b024c-898a-4bd0-98b5-f06076717b9e.htm">prepareCall</a> method of the <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a> class. The complete syntax for the<span class="code"> call </span>escape sequence is as follows:</p><p><span class="code">{[?=]call procedure-name[([parameter][,[parameter]]...)]}</span></p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>For more information about the<span class="code"> call </span>and other SQL escape sequences, see <span sdata="link"><a href="00f9e25a-088e-4ac6-aa75-43eacace8f03.htm">Using SQL Escape Sequences</a></span>.</p></div><p>The topics in this section describe the ways that you can call SQL Server stored procedures by using the JDBC driver and the<span class="code"> call </span>SQL escape sequence.</p></div><h1 class="heading">In This Section</h1><div id="inThisSectionSection" class="section" name="collapseableSection" style=""><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Topic</p></th><th><p>Description</p></th></tr><tr><td><p><span sdata="link"><a href="e9470a6d-a758-4c56-96ec-7b37139e36a7.htm">Using a Stored Procedure with No Parameters</a></span></p></td><td><p>Describes how to use the JDBC driver to run stored procedures that contain no input or output parameters.</p></td></tr><tr><td><p><span sdata="link"><a href="8f491b70-7d1b-42bd-964f-9a8b86af5eaa.htm">Using a Stored Procedure with Input Parameters</a></span></p></td><td><p>Describes how to use the JDBC driver to run stored procedures that contain input parameters.</p></td></tr><tr><td><p><span sdata="link"><a href="1c006f27-7e99-43d5-974c-7b782659290c.htm">Using a Stored Procedure with Output Parameters</a></span></p></td><td><p>Describes how to use the JDBC driver to run stored procedures that contain output parameters.</p></td></tr><tr><td><p><span sdata="link"><a href="4b126e95-8458-41d6-af37-fc6662859f19.htm">Using a Stored Procedure with a Return Status</a></span></p></td><td><p>Describes how to use the JDBC driver to run stored procedures that contain return status values.</p></td></tr><tr><td><p><span sdata="link"><a href="64cf4877-5995-4bfc-8865-b7618a5c8d01.htm">Using a Stored Procedure with an Update Count</a></span></p></td><td><p>Describes how to use the JDBC driver to run stored procedures that return update counts.</p></td></tr></table></div></div><span id="seeAlsoSpan"><h1 class="heading">See Also</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Using Statements with the JDBC Driver</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Send <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','01.00.12024.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/en-us/default.aspx.%0\A%0\d','Customer%20Feedback');">feedback</a> on this topic to Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.  All rights reserved.</a></p></span></div></div></body></html>